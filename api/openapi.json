{
  "openapi": "3.0.0",
  "info": {
    "title": "Starvis API",
    "version": "1.0.0",
    "description": "Star Citizen Ships & Components API â€” Extracted from P4K game data and RSI Ship Matrix."
  },
  "tags": [
    { "name": "Ships", "description": "Ship database (game data + RSI)" },
    { "name": "Components", "description": "Component database" },
    { "name": "Paints", "description": "Ship paint/livery database" },
    { "name": "Shops", "description": "In-game shop definitions" },
    { "name": "Manufacturers", "description": "Ship & component manufacturers" },
    { "name": "Ship Matrix", "description": "RSI Ship Matrix mirror" },
    { "name": "Loadout", "description": "Loadout simulator" },
    { "name": "Changelog", "description": "Data change tracking" },
    { "name": "System", "description": "Health & version" }
  ],
  "paths": {
    "/api/v1/ships": {
      "get": {
        "tags": ["Ships"],
        "summary": "List ships (paginated)",
        "operationId": "getShips",
        "parameters": [
          { "name": "search", "in": "query", "schema": { "type": "string" }, "description": "Search by name or class_name" },
          { "name": "manufacturer", "in": "query", "schema": { "type": "string" }, "description": "Filter by manufacturer code" },
          { "name": "career", "in": "query", "schema": { "type": "string" } },
          { "name": "role", "in": "query", "schema": { "type": "string" } },
          { "name": "status", "in": "query", "schema": { "type": "string" }, "description": "flight-ready, in-concept, in-production, in-game-only" },
          { "name": "vehicle_category", "in": "query", "schema": { "type": "string" }, "description": "ship, ground, gravlev" },
          { "name": "sort", "in": "query", "schema": { "type": "string", "default": "name" } },
          { "name": "order", "in": "query", "schema": { "type": "string", "enum": ["asc", "desc"] } },
          { "name": "page", "in": "query", "schema": { "type": "integer", "default": 1 } },
          { "name": "limit", "in": "query", "schema": { "type": "integer", "default": 50, "maximum": 200 } },
          { "name": "format", "in": "query", "schema": { "type": "string", "enum": ["json", "csv"] } }
        ],
        "responses": { "200": { "description": "Paginated ship list" } }
      }
    },
    "/api/v1/ships/filters": {
      "get": { "tags": ["Ships"], "summary": "Get available ship filter values (roles, careers)", "responses": { "200": { "description": "Filter values" } } }
    },
    "/api/v1/ships/manufacturers": {
      "get": { "tags": ["Ships"], "summary": "Get manufacturers that have ships", "responses": { "200": { "description": "Manufacturer list with ship count" } } }
    },
    "/api/v1/ships/{uuid}": {
      "get": {
        "tags": ["Ships"],
        "summary": "Get ship by UUID or class_name",
        "parameters": [{ "name": "uuid", "in": "path", "required": true, "schema": { "type": "string" } }],
        "responses": { "200": { "description": "Ship details" }, "404": { "description": "Not found" } }
      }
    },
    "/api/v1/ships/{uuid}/loadout": {
      "get": {
        "tags": ["Ships"],
        "summary": "Get ship loadout (hierarchical component tree)",
        "parameters": [{ "name": "uuid", "in": "path", "required": true, "schema": { "type": "string" } }],
        "responses": { "200": { "description": "Loadout tree" } }
      }
    },
    "/api/v1/ships/{uuid}/modules": {
      "get": {
        "tags": ["Ships"],
        "summary": "Get ship modules (Retaliator, Apollo, etc.)",
        "parameters": [{ "name": "uuid", "in": "path", "required": true, "schema": { "type": "string" } }],
        "responses": { "200": { "description": "Module list" } }
      }
    },
    "/api/v1/ships/{uuid}/paints": {
      "get": {
        "tags": ["Ships"],
        "summary": "Get available paints for a ship",
        "parameters": [{ "name": "uuid", "in": "path", "required": true, "schema": { "type": "string" } }],
        "responses": { "200": { "description": "Paint list" } }
      }
    },
    "/api/v1/ships/{uuid}/compare/{uuid2}": {
      "get": {
        "tags": ["Ships"],
        "summary": "Compare two ships",
        "parameters": [
          { "name": "uuid", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "uuid2", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "responses": { "200": { "description": "Comparison result" } }
      }
    },
    "/api/v1/ships/{uuid}/stats": {
      "get": {
        "tags": ["Ships"],
        "summary": "Get aggregated stats for a ship (weapons, shields, power, etc.)",
        "parameters": [{ "name": "uuid", "in": "path", "required": true, "schema": { "type": "string" } }],
        "responses": { "200": { "description": "Aggregated ship stats" }, "404": { "description": "Not found" } }
      }
    },
    "/api/v1/components": {
      "get": {
        "tags": ["Components"],
        "summary": "List components (paginated)",
        "parameters": [
          { "name": "search", "in": "query", "schema": { "type": "string" } },
          { "name": "type", "in": "query", "schema": { "type": "string" }, "description": "WeaponGun, Shield, QuantumDrive, etc." },
          { "name": "sub_type", "in": "query", "schema": { "type": "string" } },
          { "name": "size", "in": "query", "schema": { "type": "integer" } },
          { "name": "grade", "in": "query", "schema": { "type": "string" } },
          { "name": "manufacturer", "in": "query", "schema": { "type": "string" } },
          { "name": "sort", "in": "query", "schema": { "type": "string", "default": "name" } },
          { "name": "order", "in": "query", "schema": { "type": "string", "enum": ["asc", "desc"] } },
          { "name": "page", "in": "query", "schema": { "type": "integer", "default": 1 } },
          { "name": "limit", "in": "query", "schema": { "type": "integer", "default": 50, "maximum": 200 } }
        ],
        "responses": { "200": { "description": "Paginated component list" } }
      }
    },
    "/api/v1/components/filters": {
      "get": { "tags": ["Components"], "summary": "Get available component filter values", "responses": { "200": { "description": "types, sub_types, sizes, grades" } } }
    },
    "/api/v1/components/{uuid}": {
      "get": {
        "tags": ["Components"],
        "summary": "Get component by UUID or class_name",
        "parameters": [{ "name": "uuid", "in": "path", "required": true, "schema": { "type": "string" } }],
        "responses": { "200": { "description": "Component details" }, "404": { "description": "Not found" } }
      }
    },
    "/api/v1/components/{uuid}/buy-locations": {
      "get": {
        "tags": ["Components"],
        "summary": "Get shops selling a component",
        "parameters": [{ "name": "uuid", "in": "path", "required": true, "schema": { "type": "string" } }],
        "responses": { "200": { "description": "Buy locations with prices" } }
      }
    },
    "/api/v1/components/{uuid}/ships": {
      "get": {
        "tags": ["Components"],
        "summary": "Get ships using a component by default",
        "parameters": [{ "name": "uuid", "in": "path", "required": true, "schema": { "type": "string" } }],
        "responses": { "200": { "description": "Ship list" } }
      }
    },
    "/api/v1/paints": {
      "get": {
        "tags": ["Paints"],
        "summary": "List all paints (paginated)",
        "parameters": [
          { "name": "search", "in": "query", "schema": { "type": "string" }, "description": "Search by paint or ship name" },
          { "name": "ship_uuid", "in": "query", "schema": { "type": "string" }, "description": "Filter by ship UUID" },
          { "name": "page", "in": "query", "schema": { "type": "integer", "default": 1 } },
          { "name": "limit", "in": "query", "schema": { "type": "integer", "default": 50, "maximum": 200 } }
        ],
        "responses": { "200": { "description": "Paginated paint list" } }
      }
    },
    "/api/v1/shops": {
      "get": {
        "tags": ["Shops"],
        "summary": "List shops (paginated)",
        "parameters": [
          { "name": "search", "in": "query", "schema": { "type": "string" } },
          { "name": "location", "in": "query", "schema": { "type": "string" } },
          { "name": "type", "in": "query", "schema": { "type": "string" } },
          { "name": "page", "in": "query", "schema": { "type": "integer", "default": 1 } },
          { "name": "limit", "in": "query", "schema": { "type": "integer", "default": 20, "maximum": 100 } }
        ],
        "responses": { "200": { "description": "Paginated shop list" } }
      }
    },
    "/api/v1/shops/{id}/inventory": {
      "get": {
        "tags": ["Shops"],
        "summary": "Get shop inventory",
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "responses": { "200": { "description": "Inventory items" } }
      }
    },
    "/api/v1/manufacturers": {
      "get": { "tags": ["Manufacturers"], "summary": "List all manufacturers", "responses": { "200": { "description": "Manufacturer list" } } }
    },
    "/api/v1/ship-matrix": {
      "get": { "tags": ["Ship Matrix"], "summary": "Get all RSI Ship Matrix entries", "responses": { "200": { "description": "Ship Matrix entries" } } }
    },
    "/api/v1/ship-matrix/stats": {
      "get": { "tags": ["Ship Matrix"], "summary": "Ship Matrix statistics", "responses": { "200": { "description": "Stats" } } }
    },
    "/api/v1/ship-matrix/{id}": {
      "get": {
        "tags": ["Ship Matrix"],
        "summary": "Get Ship Matrix entry by ID or name",
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }],
        "responses": { "200": { "description": "Entry" }, "404": { "description": "Not found" } }
      }
    },
    "/api/v1/loadout/calculate": {
      "post": {
        "tags": ["Loadout"],
        "summary": "Calculate loadout stats with optional component swaps",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["shipUuid"],
                "properties": {
                  "shipUuid": { "type": "string" },
                  "swaps": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "portName": { "type": "string" },
                        "componentUuid": { "type": "string" }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": { "200": { "description": "Calculated loadout stats" } }
      }
    },
    "/api/v1/changelog": {
      "get": {
        "tags": ["Changelog"],
        "summary": "Get data changelog",
        "parameters": [
          { "name": "entity_type", "in": "query", "schema": { "type": "string" } },
          { "name": "change_type", "in": "query", "schema": { "type": "string" } },
          { "name": "limit", "in": "query", "schema": { "type": "integer", "default": 50 } },
          { "name": "offset", "in": "query", "schema": { "type": "integer", "default": 0 } }
        ],
        "responses": { "200": { "description": "Changelog entries" } }
      }
    },
    "/api/v1/version": {
      "get": { "tags": ["System"], "summary": "Get latest extraction info", "responses": { "200": { "description": "Version info" } } }
    },
    "/health": {
      "get": { "tags": ["System"], "summary": "Health check", "responses": { "200": { "description": "OK" } } }
    }
  }
}
